<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>d3 test</title>
<script type="text/javascript" src="../js/d3.v4.min.js" charset="utf-8"></script>
<link rel='stylesheet' href='./mindmap.css' />
<style>
body {
	margin : 0px;
}
</style>
</head>
<body>
	<div class='main-container'>
		<div class='left-bar'>
		</div>
		<div id='mindmapDiv' >
		</div>
		<div class='document'>
		</div>
	</div>
</body>
</html>
<script type='text/javascript' src='./data4constellation4deanchen.js' charset='utf-8'></script>
<script type='text/javascript' src='./data4mindmap.js' charset='utf-8'></script>
<script type='text/javascript' src='./nothingMap.js' charset='utf-8'></script>
<script >
	let mindmap
	let defaultStyle = 4
	//setting for display style
	/* the style class for mindmap container */
	//var containerStyle = 'mindmap-bar' 
	var containerStyle = 'mindmap-bar-2' //with background-image

	/********* the config constants for display ******************/
	const build = (i) => {
		switch(i){
			case 0:{
				build0()
				break;
			}
			case 1:{
				build1()
				break;
			}
			case 2:{
				build2()
				break;
			}
			case 3:{
				build3()
				break;
			}
			case 4:{
				build4()
				break;
			}
		}
	}
	d3.select('.left-bar').append('select')
		.on('change',function(d){
			var name = d3.event.target.value
			console.debug(`selected:${name};`)
			build(+name)
			d3.select('#mindmapDiv').selectAll('*').remove()
			mindmap = new NothingMap(data4mindmap,d3.select('#mindmapDiv'),setting)
			mindmap.setMode('twoSide')
			mindmap.update()
		})
		.selectAll('option').data([0,1,2,3,4]).enter().append('option')
			.attr('selected',function(d,i){return i === defaultStyle ? 'selected':undefined})
			.attr('value',function(d,i){return i})
			.text(function(d,i){return `style${d}`})
			

	/* setting for mindmap */
	let setting

	const build0 = () => {
		setting = undefined
	}

	/* test 1 */
	const build1 = () => {
		EASE = d3.easeElastic
		DURATION  = 1000
		// the radius of nodes
		RADIUS = 2
		//the radius of root node
		ROOT_RADIUS = 4
		//when mindmap view , scale up the radius = RADIUS * RATIO_RADIUS
		RATIO_RADIUS = 2
		
		/* the setting for mindmap class,to set up the style of node ,link and so on */
		setting = {
			noder : NoderTest1,
			linkHelper : LinkHelperTest1,
		}
	}
	
	/* test 2 */
	const build2 = () => {
		EASE = d3.easeElastic
		DURATION  = 1000
		// the radius of nodes
		RADIUS = 3
		//the radius of root node
		ROOT_RADIUS = 5
		//when mindmap view , scale up the radius = RADIUS * RATIO_RADIUS
		RATIO_RADIUS = 2
		
		/* the setting for mindmap class,to set up the style of node ,link and so on */
		setting = {
			noder : NoderTest2,
			linkHelper : LinkHelperTest2,
		}
	}

	/* big circle node  */
	const build3 = () => {
		EASE = d3.easeBackOut
		DURATION  = 500
		// the radius of nodes
		RADIUS = 10
		//the radius of root node
		ROOT_RADIUS = 20
		//when mindmap view , scale up the radius = RADIUS * RATIO_RADIUS
		RATIO_RADIUS = 2
		
		/* the setting for mindmap class,to set up the style of node ,link and so on */
		setting = {
			noder : NodeHelperBig,
			linkHelper : LinkHelperBig,
		}
	}

	/* big circle node 2  */
	const build4 = () => {
		EASE = d3.easeBackOut
		DURATION  = 500
		// the radius of nodes
		RADIUS = 10
		//the radius of root node
		ROOT_RADIUS = 20
		//when mindmap view , scale up the radius = RADIUS * RATIO_RADIUS
		RATIO_RADIUS = 2
		
		/* the setting for mindmap class,to set up the style of node ,link and so on */
		setting = {
			noder : NodeHelperBig2,
			linkHelper : LinkHelperBig2,
		}
	}
	



	d3.select('#mindmapDiv')
		.classed(containerStyle,true)
	d3.select('.left-bar').selectAll('button')
		.data(['Doc','Mindmap','Search']).enter().append('button')
			.classed('selected',function(d,i){return i === 1})
			.text(function(d){return d})
			.on('click',function(d){
				d3.select('.left-bar').selectAll('button').classed('selected',false)
				d3.select(this).classed('selected',true)
				if(d === 'Mindmap'){
					//change to mindmap container
					console.log('change to mindmap container')
					d3.select('#mindmapDiv')
						.transition()
						.duration(DURATION)
						.ease(EASE)
						.style('width',`${window.innerWidth - 70}px`)
					mindmap.setMode('twoSide')
					mindmap.update()
				}else if(d === 'Doc'){
					//change to doc container
					console.log('change to mindmap container')
					d3.select('#mindmapDiv')
						.transition()
						.duration(DURATION)
						.ease(EASE)
						.style('width','310px')
					mindmap.setMode('single')
					mindmap.update()
				}else if(d === 'Search'){
					mindmap.setMode('search')
					mindmap.update()
				}
				})

	build(defaultStyle)
	
	mindmap = new NothingMap(data4mindmap,d3.select('#mindmapDiv'),setting)
	mindmap.setMode('twoSide')
	mindmap.update()
</script>
